# 💩 TurboWarp / Scratch 屎山代码检测器 (NextGen)

> *"让你的烂代码无处遁形！(分数越高越烂)"* —— **By HYPIXICE**

![Python Version](https://img.shields.io/badge/Python-3.6%2B-blue)
![Dependencies](https://img.shields.io/badge/dependencies-rich-green)
![License](https://img.shields.io/badge/license-MIT-yellow)

这是一个专门为 Scratch 3.0 (`.sb3`) 和 TurboWarp 项目打造的**静态代码审查工具**。它会深入你的项目文件，通过多种维度分析积木代码的“坏味道”，并为你计算出一个**“屎山指数 (Shit-Gas Index)”**。

还在为接手别人的 Scratch 项目而头疼吗？还在为自己几个月前写的超级面条代码而忏悔吗？用它扫一下，一切烂代码都将无所遁形！

## ✨ 核心检测维度

本检测器目前支持以下“屎山”特征的诊断：
- 🏷️ **命名规范**：检测无意义的默认命名（如 `Sprite1`、`变量1`、`未命名` 等）。
- 🌲 **逻辑复杂度**：检测“箭头形代码”（恐怖的嵌套深度），提醒你提炼函数。
- 🧱 **代码体积**：精准定位长达几百个积木的“上帝脚本”，以及极度臃肿的状态管理（单角色超过50个变量）。
- 👻 **死代码/幽灵代码**：揪出未连接事件的废弃代码片段和空控制流积木。
- 📝 **代码注释**：当某个角色的代码量极大却**没有任何注释**时，触发警告。
- 👯 **代码重复度 (CV大法)**：通过生成脚本指纹，自动跨角色找出完全一样的复制粘贴代码。

## 📦 安装说明

1. 确保你的电脑上安装了 Python 3.6 或更高版本。
2. 安装依赖库：
   ```bash
   pip install -r requirements.txt
   ```
3. 下载本仓库的脚本文件（如 `sb3_analyzer.py`）。

## 🚀 使用方法

在终端或命令行中运行脚本，并传入你要检测的 `.sb3` 或 `.pmp` 文件路径：

```bash
python sb3_analyzer.py path/to/your/project.sb3
```

### 🛠️ 进阶参数

| 参数 | 描述 | 默认值 |
| :--- | :--- | :--- |
| `file` | 必填，要评判的 `.sb3` / `.pmp` 文件路径。 | - |
| `--top` | 最多显示的扣分项数量，项目太大时可以只看最严重的问题。 | `20` |
| `--name-width` | 指定第一列(角色名)的列宽，防止长名字被截断。 | `18` |
| `--lenient` | 开启**【宽松模式】**：降低检测标准并减少扣分（适合老旧的大型项目）。 | `False` |

**示例：使用宽松模式，并显示前 50 个严重问题**
```bash
python sb3_analyzer.py project.pmp --lenient --top 50
```

## 📊 屎山评级标准

检测完成后，工具会汇总所有的扣分项，并给出最终的“屎山指数”和评级：

- 💎 **A+ (完美纯净)** `[0 点]`：代码纯洁得像一朵白莲花，建议直接入选 Scratch 教科书！
- 🟢 **A (优秀)** `[1 - 20 点]`：代码结构整洁，只有一些无关痛痒的小毛病。
- 🟡 **B (良好/屎山雏形)** `[21 - 60 点]`：还能看，但也仅限还能看。屎山的雏形已经显现，现在重构还来得及！
- 🟣 **C (警告/深陷屎山)** `[61 - 150 点]`：生化武器预警！代码里充斥着重复、超长上帝脚本和神秘命名！
- 🔴 **D (不可救药/电子越野)** `[> 150 点]`：天哪...代码写得像是在键盘上撒把米让鸡啄出来的一样。建议重写跑路！

## 👨‍💻 作者与支持

- **Author:** [HYPIXICE](https://www.hypixice.top)
- **Website:**[https://www.hypixice.top](https://www.hypixice.top)

如果你觉得这个工具有趣且有用，欢迎提交 PR 增加更多检测规则，或者给个 Star ⭐️！
